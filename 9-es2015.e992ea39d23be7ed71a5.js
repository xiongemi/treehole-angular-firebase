(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{xZLo:function(t,e,s){"use strict";s.r(e),s.d(e,"PostsModule",function(){return Q});var n=s("AcyG"),i=s("3Pt+"),o=s("PCNd"),c=s("tyNb"),r=s("n90j"),a=s("quSY"),b=s("zONo"),l=s("Jsfd"),h=s("XKO9"),u=s("B0Pf");let p=(()=>{class t{constructor(t,e){this.language=t,this.sortBy=e}}return t.type="[Posts] Get",t})(),g=(()=>{class t{constructor(t){this.pageIndex=t}}return t.type="[Posts] Change Page Index",t})(),d=(()=>{class t{constructor(t){this.pageSize=t}}return t.type="[Posts] Change Page Size",t})();const m=t=>t.posts,z=t=>m(t).posts,f=Object(n.k)([z],t=>t.length),y=t=>m(t).pageSize,k=Object(n.k)([z,t=>m(t).pageIndex,y],(t,e,s)=>t.slice((e-1)*s,e*s));var P=s("fXoL"),S=s("YaLo"),E=s("ofXK"),C=s("Ff2k"),w=s("3/1E"),O=s("zAKX"),V=s("OzZK"),I=s("C2AL"),B=s("FwiY"),L=s("Mean"),j=s("RwU8"),x=s("sYmb");function W(t,e){if(1&t&&(P.Wb(0,"form",6),P.Wb(1,"nz-select",7),P.Rb(2,"nz-option",8),P.hc(3,"translate"),P.Rb(4,"nz-option",8),P.hc(5,"translate"),P.Rb(6,"nz-option",8),P.hc(7,"translate"),P.Rb(8,"nz-option",8),P.hc(9,"translate"),P.Rb(10,"nz-option",8),P.hc(11,"translate"),P.Vb(),P.Vb()),2&t){const t=P.gc();P.mc("formGroup",t.searchForm),P.Eb(2),P.mc("nzValue",t.SortBy.NewestPosts)("nzLabel",P.ic(3,11,t.SortBy.NewestPosts)),P.Eb(2),P.mc("nzValue",t.SortBy.OldestPosts)("nzLabel",P.ic(5,13,t.SortBy.OldestPosts)),P.Eb(2),P.mc("nzValue",t.SortBy.MostLikes)("nzLabel",P.ic(7,15,t.SortBy.MostLikes)),P.Eb(2),P.mc("nzValue",t.SortBy.MostDislikes)("nzLabel",P.ic(9,17,t.SortBy.MostDislikes)),P.Eb(2),P.mc("nzValue",t.SortBy.MostComments)("nzLabel",P.ic(11,19,t.SortBy.MostComments))}}const v=function(t){return["/post",t]};function F(t,e){if(1&t){const t=P.Xb();P.Wb(0,"nz-list-item",9),P.Wb(1,"nz-list-item-meta"),P.Wb(2,"nz-list-item-meta-title"),P.Wb(3,"a",10),P.Ec(4),P.Vb(),P.Vb(),P.Wb(5,"nz-list-item-meta-description"),P.Ec(6),P.hc(7,"date"),P.Vb(),P.Vb(),P.Wb(8,"a",10),P.Ec(9),P.Vb(),P.Wb(10,"ul",11),P.Wb(11,"nz-list-item-action"),P.Wb(12,"button",12),P.dc("click",function(){P.uc(t);const s=e.$implicit;return P.gc().like(s)}),P.Rb(13,"i",13),P.hc(14,"async"),P.Ec(15),P.Vb(),P.Vb(),P.Wb(16,"nz-list-item-action"),P.Wb(17,"button",12),P.dc("click",function(){P.uc(t);const s=e.$implicit;return P.gc().dislike(s)}),P.Rb(18,"i",14),P.hc(19,"async"),P.Ec(20),P.Vb(),P.Vb(),P.Wb(21,"nz-list-item-action"),P.Wb(22,"a",10),P.Rb(23,"i",15),P.Ec(24),P.Vb(),P.Vb(),P.Vb(),P.Vb()}if(2&t){const t=e.$implicit,s=P.gc();P.mc("nzNoFlex",!0),P.Eb(3),P.mc("routerLink",P.pc(19,v,t.id)),P.Eb(1),P.Fc(t.title),P.Eb(2),P.Gc(" ",P.jc(7,12,t.createdAt,"medium")," "),P.Eb(2),P.mc("routerLink",P.pc(21,v,t.id)),P.Eb(1),P.Fc(t.message),P.Eb(4),P.mc("nzTheme",P.ic(14,15,s.doesUserLikesComment$(t.id))?"fill":"outline"),P.Eb(2),P.Gc(" ",t.likesCount," "),P.Eb(3),P.mc("nzTheme",P.ic(19,17,s.doesUserDislikesComment$(t.id))?"fill":"outline"),P.Eb(2),P.Gc(" ",t.dislikesCount," "),P.Eb(2),P.mc("routerLink",P.pc(23,v,t.id)),P.Eb(2),P.Gc(" ",t.commentsCount," ")}}function $(t,e){if(1&t){const t=P.Xb();P.Wb(0,"nz-result",16),P.hc(1,"translate"),P.Wb(2,"div",17),P.Wb(3,"button",18),P.dc("click",function(){return P.uc(t),P.gc().getPosts()}),P.Ec(4),P.hc(5,"translate"),P.Vb(),P.Vb(),P.Vb()}2&t&&(P.mc("nzTitle",P.ic(1,2,"MESSAGES.FAILED")),P.Eb(4),P.Gc(" ",P.ic(5,4,"RETRY")," "))}const N=[{path:"",component:(()=>{class t{constructor(t,e,s){this.store=t,this.actions=e,this.likeDislikeService=s,this.posts=[],this.searchForm=new i.g({sortBy:new i.d(b.a.NewestPosts)}),this.SortBy=b.a,this.loading=!0,this.hasError=!1,this.subscription=new a.a}ngOnInit(){this.getPosts(),this.subscription.add(this.actions.pipe(Object(n.o)(l.a)).subscribe(()=>{this.getPosts()})),this.subscription.add(this.searchForm.get("sortBy").valueChanges.subscribe(()=>{this.getPosts()})),this.subscription.add(this.store.select(k).subscribe(t=>{this.posts=Object(r.a)(t)})),this.totalPostNumber$=this.store.select(f),this.pageSize$=this.store.select(y),this.pageIndex$=this.store.select(y)}ngOnDestroy(){this.subscription.unsubscribe()}getPosts(){this.store.dispatch(new p(this.store.selectSnapshot(h.a),this.searchForm.value.sortBy)).subscribe(()=>{this.loading=!1,this.hasError=!1},()=>{this.loading=!1,this.hasError=!0})}onPageIndexChange(t){this.store.dispatch(new g(t))}onPageSizeChange(t){this.store.dispatch(new d(t))}doesUserLikesComment$(t){return this.store.select(Object(u.b)(t))}doesUserDislikesComment$(t){return this.store.select(Object(u.a)(t))}like(t){this.likeDislikeService.like(this.doesUserLikesComment$(t.id),this.doesUserDislikesComment$(t.id),t)}dislike(t){this.likeDislikeService.dislike(this.doesUserLikesComment$(t.id),this.doesUserDislikesComment$(t.id),t)}}return t.\u0275fac=function(e){return new(e||t)(P.Qb(n.h),P.Qb(n.b),P.Qb(S.a))},t.\u0275cmp=P.Kb({type:t,selectors:[["app-posts-home"]],decls:9,vars:14,consts:[["class","mb3",3,"formGroup",4,"ngIf"],["nzItemLayout","vertical",1,"bg-white",3,"nzLoading","nzBordered"],[3,"nzNoFlex",4,"ngFor","ngForOf"],[1,"tc","mt3"],["nzShowSizeChanger","",3,"nzPageIndex","nzPageSize","nzTotal","nzPageSizeChang","nzPageIndexChange"],["nzStatus","warning",3,"nzTitle",4,"ngIf"],[1,"mb3",3,"formGroup"],["formControlName","sortBy"],[3,"nzValue","nzLabel"],[3,"nzNoFlex"],[3,"routerLink"],["nz-list-item-actions",""],["nz-button","","nzType","link",3,"click"],["nz-icon","","nzType","like",3,"nzTheme"],["nz-icon","","nzType","dislike",3,"nzTheme"],["nz-icon","","nzType","comment"],["nzStatus","warning",3,"nzTitle"],["nz-result-extra",""],["nz-button","","nzType","primary",3,"click"]],template:function(t,e){1&t&&(P.Cc(0,W,12,21,"form",0),P.Wb(1,"nz-list",1),P.Cc(2,F,25,25,"nz-list-item",2),P.Vb(),P.Wb(3,"div",3),P.Wb(4,"nz-pagination",4),P.dc("nzPageSizeChang",function(t){return e.onPageSizeChange(t)})("nzPageIndexChange",function(t){return e.onPageIndexChange(t)}),P.hc(5,"async"),P.hc(6,"async"),P.hc(7,"async"),P.Vb(),P.Vb(),P.Cc(8,$,6,6,"nz-result",5)),2&t&&(P.mc("ngIf",!e.loading&&!e.hasError),P.Eb(1),P.mc("nzLoading",e.loading)("nzBordered",!0),P.Eb(1),P.mc("ngForOf",e.posts),P.Eb(2),P.mc("nzPageIndex",P.ic(5,8,e.pageIndex$))("nzPageSize",P.ic(6,10,e.pageSize$))("nzTotal",P.ic(7,12,e.totalPostNumber$)),P.Eb(4),P.mc("ngIf",!e.loading&&e.hasError))},directives:[E.m,C.a,E.l,w.a,i.s,i.o,i.h,O.b,i.n,i.f,O.a,C.d,C.e,C.g,c.g,C.f,C.c,C.b,V.a,I.a,B.a,L.a,L.b,j.a],pipes:[E.b,x.c,E.e],styles:[""]}),t})(),data:{reuse:!0}}];let T=(()=>{class t{}return t.\u0275mod=P.Ob({type:t}),t.\u0275inj=P.Nb({factory:function(e){return new(e||t)},imports:[[c.h.forChild(N)],c.h]}),t})();var D=s("lJxs"),G=s("bO7i"),M=s("I/3d");let R=(()=>{class t{constructor(t){this.firestore=t}getPosts(t="en",e,s=null){const{orderByField:n,orderByDirection:i}=b.b[e];return this.firestore.collection("posts",e=>{let o=e.where("language","==",t).orderBy(n,i);return s&&(o=e.startAfter(s)),o}).get().pipe(Object(D.a)(t=>t.docs.map(t=>{const e=Object(G.a)(t.data());return e.id=t.id,e})))}}return t.\u0275fac=function(e){return new(e||t)(P.ac(M.a))},t.\u0275prov=P.Mb({token:t,factory:t.\u0275fac}),t})();var U=s("mrSG"),A=s("vkgz"),X=s("JIr8"),J=s("EBwW");const K={posts:null,pageIndex:1,pageSize:10};let Y=(()=>{let t=class{constructor(t){this.postsSerivce=t}getPosts(t,e){return t.patchState({posts:null}),this.postsSerivce.getPosts(e.language,e.sortBy).pipe(Object(A.a)(e=>{if(!e||!e.length)throw e;t.patchState({posts:e})}),Object(X.a)(e=>{throw t.dispatch(new J.a),e}))}changePostsPageIndex(t,e){t.patchState({pageIndex:e.pageIndex})}changePostsPageNumber(t,e){t.patchState({pageSize:e.pageSize})}};return t.\u0275fac=function(e){return new(e||t)(P.ac(R))},t.\u0275prov=P.Mb({token:t,factory:t.\u0275fac}),Object(U.b)([Object(n.a)(p)],t.prototype,"getPosts",null),Object(U.b)([Object(n.a)(g)],t.prototype,"changePostsPageIndex",null),Object(U.b)([Object(n.a)(d)],t.prototype,"changePostsPageNumber",null),t=Object(U.b)([Object(n.f)({name:"posts",defaults:Object.assign({},K)})],t),t})(),Q=(()=>{class t{}return t.\u0275mod=P.Ob({type:t}),t.\u0275inj=P.Nb({factory:function(e){return new(e||t)},providers:[R],imports:[[o.a,T,n.e.forFeature([Y]),i.i,i.q]]}),t})()}}]);