!function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function e(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{xZLo:function(t,i,s){"use strict";s.r(i),s.d(i,"PostsModule",function(){return nt});var o=s("AcyG"),c=s("3Pt+"),r=s("PCNd"),a=s("tyNb"),u=s("n90j"),l=s("quSY"),b=s("zONo"),h=s("Jsfd"),f=s("XKO9"),p=s("B0Pf"),g=function(){var t=function t(e,i){n(this,t),this.language=e,this.sortBy=i};return t.type="[Posts] Get",t}(),d=function(){var t=function t(e){n(this,t),this.pageIndex=e};return t.type="[Posts] Change Page Index",t}(),m=function(){var t=function t(e){n(this,t),this.pageSize=e};return t.type="[Posts] Change Page Size",t}(),z=function(t){return t.posts},y=function(t){return z(t).posts},k=Object(o.k)([y],function(t){return t.length}),v=function(t){return z(t).pageSize},P=Object(o.k)([y,function(t){return z(t).pageIndex},v],function(t,e,n){return t.slice((e-1)*n,e*n)}),S=s("fXoL"),E=s("YaLo"),w=s("ofXK"),C=s("Ff2k"),O=s("3/1E"),V=s("zAKX"),I=s("OzZK"),j=s("C2AL"),B=s("FwiY"),L=s("Mean"),x=s("RwU8"),W=s("sYmb");function F(t,e){if(1&t&&(S.Wb(0,"form",6),S.Wb(1,"nz-select",7),S.Rb(2,"nz-option",8),S.hc(3,"translate"),S.Rb(4,"nz-option",8),S.hc(5,"translate"),S.Rb(6,"nz-option",8),S.hc(7,"translate"),S.Rb(8,"nz-option",8),S.hc(9,"translate"),S.Rb(10,"nz-option",8),S.hc(11,"translate"),S.Vb(),S.Vb()),2&t){var n=S.gc();S.mc("formGroup",n.searchForm),S.Eb(2),S.mc("nzValue",n.SortBy.NewestPosts)("nzLabel",S.ic(3,11,n.SortBy.NewestPosts)),S.Eb(2),S.mc("nzValue",n.SortBy.OldestPosts)("nzLabel",S.ic(5,13,n.SortBy.OldestPosts)),S.Eb(2),S.mc("nzValue",n.SortBy.MostLikes)("nzLabel",S.ic(7,15,n.SortBy.MostLikes)),S.Eb(2),S.mc("nzValue",n.SortBy.MostDislikes)("nzLabel",S.ic(9,17,n.SortBy.MostDislikes)),S.Eb(2),S.mc("nzValue",n.SortBy.MostComments)("nzLabel",S.ic(11,19,n.SortBy.MostComments))}}var $=function(t){return["/post",t]};function N(t,e){if(1&t){var n=S.Xb();S.Wb(0,"nz-list-item",9),S.Wb(1,"nz-list-item-meta"),S.Wb(2,"nz-list-item-meta-title"),S.Wb(3,"a",10),S.Ec(4),S.Vb(),S.Vb(),S.Wb(5,"nz-list-item-meta-description"),S.Ec(6),S.hc(7,"date"),S.Vb(),S.Vb(),S.Wb(8,"a",10),S.Ec(9),S.Vb(),S.Wb(10,"ul",11),S.Wb(11,"nz-list-item-action"),S.Wb(12,"button",12),S.dc("click",function(){S.uc(n);var t=e.$implicit;return S.gc().like(t)}),S.Rb(13,"i",13),S.hc(14,"async"),S.Ec(15),S.Vb(),S.Vb(),S.Wb(16,"nz-list-item-action"),S.Wb(17,"button",12),S.dc("click",function(){S.uc(n);var t=e.$implicit;return S.gc().dislike(t)}),S.Rb(18,"i",14),S.hc(19,"async"),S.Ec(20),S.Vb(),S.Vb(),S.Wb(21,"nz-list-item-action"),S.Wb(22,"a",10),S.Rb(23,"i",15),S.Ec(24),S.Vb(),S.Vb(),S.Vb(),S.Vb()}if(2&t){var i=e.$implicit,s=S.gc();S.mc("nzNoFlex",!0),S.Eb(3),S.mc("routerLink",S.pc(19,$,i.id)),S.Eb(1),S.Fc(i.title),S.Eb(2),S.Gc(" ",S.jc(7,12,i.createdAt,"medium")," "),S.Eb(2),S.mc("routerLink",S.pc(21,$,i.id)),S.Eb(1),S.Fc(i.message),S.Eb(4),S.mc("nzTheme",S.ic(14,15,s.doesUserLikesComment$(i.id))?"fill":"outline"),S.Eb(2),S.Gc(" ",i.likesCount," "),S.Eb(3),S.mc("nzTheme",S.ic(19,17,s.doesUserDislikesComment$(i.id))?"fill":"outline"),S.Eb(2),S.Gc(" ",i.dislikesCount," "),S.Eb(2),S.mc("routerLink",S.pc(23,$,i.id)),S.Eb(2),S.Gc(" ",i.commentsCount," ")}}function T(t,e){if(1&t){var n=S.Xb();S.Wb(0,"nz-result",16),S.hc(1,"translate"),S.Wb(2,"div",17),S.Wb(3,"button",18),S.dc("click",function(){return S.uc(n),S.gc().getPosts()}),S.Ec(4),S.hc(5,"translate"),S.Vb(),S.Vb(),S.Vb()}2&t&&(S.mc("nzTitle",S.ic(1,2,"MESSAGES.FAILED")),S.Eb(4),S.Gc(" ",S.ic(5,4,"RETRY")," "))}var D,G,M,R,U,A=[{path:"",component:(D=function(){function t(e,i,s){n(this,t),this.store=e,this.actions=i,this.likeDislikeService=s,this.posts=[],this.searchForm=new c.g({sortBy:new c.d(b.a.NewestPosts)}),this.SortBy=b.a,this.loading=!0,this.hasError=!1,this.subscription=new l.a}return e(t,[{key:"ngOnInit",value:function(){var t=this;this.getPosts(),this.subscription.add(this.actions.pipe(Object(o.o)(h.a)).subscribe(function(){t.getPosts()})),this.subscription.add(this.searchForm.get("sortBy").valueChanges.subscribe(function(){t.getPosts()})),this.subscription.add(this.store.select(P).subscribe(function(e){t.posts=Object(u.a)(e)})),this.totalPostNumber$=this.store.select(k),this.pageSize$=this.store.select(v),this.pageIndex$=this.store.select(v)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"getPosts",value:function(){var t=this;this.store.dispatch(new g(this.store.selectSnapshot(f.a),this.searchForm.value.sortBy)).subscribe(function(){t.loading=!1,t.hasError=!1},function(){t.loading=!1,t.hasError=!0})}},{key:"onPageIndexChange",value:function(t){this.store.dispatch(new d(t))}},{key:"onPageSizeChange",value:function(t){this.store.dispatch(new m(t))}},{key:"doesUserLikesComment$",value:function(t){return this.store.select(Object(p.b)(t))}},{key:"doesUserDislikesComment$",value:function(t){return this.store.select(Object(p.a)(t))}},{key:"like",value:function(t){this.likeDislikeService.like(this.doesUserLikesComment$(t.id),this.doesUserDislikesComment$(t.id),t)}},{key:"dislike",value:function(t){this.likeDislikeService.dislike(this.doesUserLikesComment$(t.id),this.doesUserDislikesComment$(t.id),t)}}]),t}(),D.\u0275fac=function(t){return new(t||D)(S.Qb(o.h),S.Qb(o.b),S.Qb(E.a))},D.\u0275cmp=S.Kb({type:D,selectors:[["app-posts-home"]],decls:9,vars:14,consts:[["class","mb3",3,"formGroup",4,"ngIf"],["nzItemLayout","vertical",1,"bg-white",3,"nzLoading","nzBordered"],[3,"nzNoFlex",4,"ngFor","ngForOf"],[1,"tc","mt3"],["nzShowSizeChanger","",3,"nzPageIndex","nzPageSize","nzTotal","nzPageSizeChang","nzPageIndexChange"],["nzStatus","warning",3,"nzTitle",4,"ngIf"],[1,"mb3",3,"formGroup"],["formControlName","sortBy"],[3,"nzValue","nzLabel"],[3,"nzNoFlex"],[3,"routerLink"],["nz-list-item-actions",""],["nz-button","","nzType","link",3,"click"],["nz-icon","","nzType","like",3,"nzTheme"],["nz-icon","","nzType","dislike",3,"nzTheme"],["nz-icon","","nzType","comment"],["nzStatus","warning",3,"nzTitle"],["nz-result-extra",""],["nz-button","","nzType","primary",3,"click"]],template:function(t,e){1&t&&(S.Cc(0,F,12,21,"form",0),S.Wb(1,"nz-list",1),S.Cc(2,N,25,25,"nz-list-item",2),S.Vb(),S.Wb(3,"div",3),S.Wb(4,"nz-pagination",4),S.dc("nzPageSizeChang",function(t){return e.onPageSizeChange(t)})("nzPageIndexChange",function(t){return e.onPageIndexChange(t)}),S.hc(5,"async"),S.hc(6,"async"),S.hc(7,"async"),S.Vb(),S.Vb(),S.Cc(8,T,6,6,"nz-result",5)),2&t&&(S.mc("ngIf",!e.loading&&!e.hasError),S.Eb(1),S.mc("nzLoading",e.loading)("nzBordered",!0),S.Eb(1),S.mc("ngForOf",e.posts),S.Eb(2),S.mc("nzPageIndex",S.ic(5,8,e.pageIndex$))("nzPageSize",S.ic(6,10,e.pageSize$))("nzTotal",S.ic(7,12,e.totalPostNumber$)),S.Eb(4),S.mc("ngIf",!e.loading&&e.hasError))},directives:[w.m,C.a,w.l,O.a,c.s,c.o,c.h,V.b,c.n,c.f,V.a,C.d,C.e,C.g,a.g,C.f,C.c,C.b,I.a,j.a,B.a,L.a,L.b,x.a],pipes:[w.b,W.c,w.e],styles:[""]}),D),data:{reuse:!0}}],X=((G=function t(){n(this,t)}).\u0275mod=S.Ob({type:G}),G.\u0275inj=S.Nb({factory:function(t){return new(t||G)},imports:[[a.h.forChild(A)],a.h]}),G),J=s("lJxs"),K=s("bO7i"),Y=s("I/3d"),Q=((M=function(){function t(e){n(this,t),this.firestore=e}return e(t,[{key:"getPosts",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=b.b[e],s=i.orderByField,o=i.orderByDirection;return this.firestore.collection("posts",function(e){var i=e.where("language","==",t).orderBy(s,o);return n&&(i=e.startAfter(n)),i}).get().pipe(Object(J.a)(function(t){return t.docs.map(function(t){var e=Object(K.a)(t.data());return e.id=t.id,e})}))}}]),t}()).\u0275fac=function(t){return new(t||M)(S.ac(Y.a))},M.\u0275prov=S.Mb({token:M,factory:M.\u0275fac}),M),q=s("mrSG"),Z=s("vkgz"),H=s("JIr8"),_=s("EBwW"),tt={posts:null,pageIndex:1,pageSize:10},et=((U=function(){function t(e){n(this,t),this.postsSerivce=e}return e(t,[{key:"getPosts",value:function(t,e){return t.patchState({posts:null}),this.postsSerivce.getPosts(e.language,e.sortBy).pipe(Object(Z.a)(function(e){if(!e||!e.length)throw e;t.patchState({posts:e})}),Object(H.a)(function(e){throw t.dispatch(new _.a),e}))}},{key:"changePostsPageIndex",value:function(t,e){t.patchState({pageIndex:e.pageIndex})}},{key:"changePostsPageNumber",value:function(t,e){t.patchState({pageSize:e.pageSize})}}]),t}()).\u0275fac=function(t){return new(t||U)(S.ac(Q))},U.\u0275prov=S.Mb({token:U,factory:U.\u0275fac}),Object(q.b)([Object(o.a)(g)],U.prototype,"getPosts",null),Object(q.b)([Object(o.a)(d)],U.prototype,"changePostsPageIndex",null),Object(q.b)([Object(o.a)(m)],U.prototype,"changePostsPageNumber",null),U=Object(q.b)([Object(o.f)({name:"posts",defaults:Object.assign({},tt)})],U)),nt=((R=function t(){n(this,t)}).\u0275mod=S.Ob({type:R}),R.\u0275inj=S.Nb({factory:function(t){return new(t||R)},providers:[Q],imports:[[r.a,X,o.e.forFeature([et]),c.i,c.q]]}),R)}}])}();